{"version":3,"sources":["webpack:///./src/views/todo/todo-list.vue?8e1b","webpack:///./src/views/todo/todo-list.vue?fc2f","webpack:///./src/views/todo/todo-list.vue","webpack:///./node_modules/.pnpm/registry.npmmirror.com+@element-plus+icons-vue@1.1.4_vue@3.2.41/node_modules/@element-plus/icons-vue/dist/es/delete.mjs","webpack:///./src/utils/indexdb.ts"],"names":["_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","_createElementVNode","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","key","_hoisted_9","_hoisted_10","_defineComponent","__name","setup","__props","todoItem","ref","id","Date","now","checked","focus","todo","vFocus","mounted","el","database","Database","connect","then","res","hasObjectStoreNames","request","db","transaction","objectStore","getAll","onsuccess","value","result","length","initTodoTable","name","unique","create","keyPath","handleToDoItem","item","forEach","add","state","date","toLocaleString","push","handleToDoItemFocus","data","handleToDoItemDelete","index","splice","_ctx","_cache","_component_el_checkbox","_resolveComponent","_component_el_button","_openBlock","_createElementBlock","_Fragment","_renderList","_createVNode","modelValue","$event","size","onClick","_toDisplayString","_createCommentVNode","_withDirectives","autofocus","type","row","onKeyup","_withKeys","_vModelText","icon","_unref","Delete","circle","__exports__","_sfc_main","viewBox","xmlns","fill","d","_sfc_render","$props","$setup","$data","$options","_delete","constructor","dbName","version","Promise","resolve","reject","this","window","indexedDB","open","e","success","onerror","error","onupgradeneeded","target","upgrad","sql","get","call","update","put","delete","cursor","tableName","openCursor","createIndex","getIndex","objectStoreNames","contains","options","createObjectStore","autoIncrement","message","console","log"],"mappings":"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","file":"js/chunk-60183a9c.19f416a9.js","sourcesContent":["export * from \"-!../../../node_modules/.pnpm/registry.npmmirror.com+mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/.pnpm/registry.npmmirror.com+css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.2.41_vue@3.2.41_webpack@4.46.0/node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/.pnpm/registry.npmmirror.com+postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/.pnpm/registry.npmmirror.com+sass-loader@10.3.1_node-sass@6.0.1_webpack@4.46.0/node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/.pnpm/registry.npmmirror.com+cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/.pnpm/vue-loader@16.8.3_@vue+compiler-sfc@3.2.41_vue@3.2.41_webpack@4.46.0/node_modules/vue-loader/dist/index.js??ref--1-1!./todo-list.vue?vue&type=style&index=0&id=3929e0da&lang=scss&scoped=true\"","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, unref as _unref, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3929e0da\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"todo-warpper\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"todo-header\" }, \"代办清单\", -1))\nconst _hoisted_3 = { class: \"todo-inner\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"todo-date\" }, \"2023-08-13\", -1))\nconst _hoisted_5 = { class: \"todo-list\" }\nconst _hoisted_6 = { class: \"todo-checkbox-warp\" }\nconst _hoisted_7 = [\"onClick\"]\nconst _hoisted_8 = {\n  key: 0,\n  class: \"todo-content-text\"\n}\nconst _hoisted_9 = [\"onUpdate:modelValue\", \"autofocus\", \"onKeyup\"]\nconst _hoisted_10 = {\n  key: 0,\n  class: \"todo-delete-warp\"\n}\n\nimport { Delete } from '@element-plus/icons-vue'\r\nimport { computed, defineComponent, nextTick, onMounted, reactive, ref, toRefs } from 'vue'\r\nimport Database from '@/utils/indexdb'\r\ninterface ToDoItem {\r\n  id: string | number,\r\n  checked: boolean,\r\n  focus: boolean,\r\n  todo: string\r\n}\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'todo-list',\n  setup(__props) {\n\r\nconst todoItem = ref([{\r\n  id: Date.now(),\r\n  checked: false,\r\n  focus: true,\r\n  todo: ''\r\n}])\r\n// 必须以v开头的指令才能起效\r\nconst vFocus = {\r\n  mounted: (el: HTMLInputElement) => el.focus()\r\n}\r\nconst database = new Database()\r\ndatabase.connect('database', 1).then(res => {\r\n  if (database.hasObjectStoreNames('todo')) {\r\n    const request = database.db.transaction(['todo']).objectStore('todo').getAll()\r\n    request.onsuccess = function () {\r\n      todoItem.value = request.result.length > 0 ? request.result : [{\r\n        id: Date.now(),\r\n        checked: false,\r\n        focus: true,\r\n        todo: ''\r\n      }]\r\n    }\r\n  } else {\r\n    const initTodoTable = [\r\n      { name: 'id', unique: false },\r\n      { name: 'checked', unique: false },\r\n      { name: 'focus', unique: false },\r\n      { name: 'todo', unique: false },\r\n      { name: 'state', unique: false },\r\n      { name: 'date', unique: false }\r\n    ]\r\n    database.create('todo', initTodoTable, { keyPath: 'id' })\r\n  }\r\n})\r\nconst handleToDoItem = (item: ToDoItem) => {\r\n  if (!item.todo) return\r\n  todoItem.value.forEach(item => {\r\n    item.focus = false\r\n    database.add('todo', {...item, state: item.checked ? 2 : 1, date: new Date().toLocaleString()})\r\n  })\r\n  todoItem.value.push({\r\n    id: Date.now(),\r\n    checked: false,\r\n    focus: true,\r\n    todo: ''\r\n  })\r\n}\r\nconst handleToDoItemFocus = (data: ToDoItem) => {\r\n  todoItem.value.forEach(item => {\r\n    if (item.id === data.id) {\r\n      item.focus = true\r\n    } else {\r\n      item.focus = false\r\n    }\r\n  })\r\n}\r\nconst handleToDoItemDelete = (data: ToDoItem, index: number) => {\r\n  todoItem.value.splice(index, 1)\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_checkbox = _resolveComponent(\"el-checkbox\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n\n  return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n    _hoisted_2,\n    _createElementVNode(\"section\", _hoisted_3, [\n      _hoisted_4,\n      _createElementVNode(\"div\", _hoisted_5, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(todoItem.value, (item, index) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: index,\n            class: \"todo-item\"\n          }, [\n            _createElementVNode(\"div\", _hoisted_6, [\n              _createVNode(_component_el_checkbox, {\n                modelValue: item.checked,\n                \"onUpdate:modelValue\": ($event: any) => ((item.checked) = $event),\n                size: \"large\"\n              }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n            ]),\n            _createElementVNode(\"div\", {\n              class: \"todo-content-warp\",\n              onClick: ($event: any) => (handleToDoItemFocus(item))\n            }, [\n              (item.todo && !item.focus)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(item.todo), 1))\n                : _createCommentVNode(\"\", true),\n              (item.focus)\n                ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                    key: 1,\n                    \"onUpdate:modelValue\": ($event: any) => ((item.todo) = $event),\n                    autofocus: item.focus,\n                    type: \"textarea\",\n                    row: \"1\",\n                    class: \"todo-content-textarea\",\n                    onKeyup: _withKeys(($event: any) => (handleToDoItem(item)), [\"enter\",\"native\"])\n                  }, null, 40, _hoisted_9)), [\n                    [_vModelText, item.todo],\n                    [vFocus]\n                  ])\n                : _createCommentVNode(\"\", true)\n            ], 8, _hoisted_7),\n            (todoItem.value.length > 1)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                  _createVNode(_component_el_button, {\n                    type: \"danger\",\n                    icon: _unref(Delete),\n                    circle: \"\",\n                    onClick: ($event: any) => (handleToDoItemDelete(item, index))\n                  }, null, 8, [\"icon\", \"onClick\"])\n                ]))\n              : _createCommentVNode(\"\", true)\n          ]))\n        }), 128))\n      ])\n    ])\n  ]))\n}\n}\n\n})","import script from \"./todo-list.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./todo-list.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./todo-list.vue?vue&type=style&index=0&id=3929e0da&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\workspace\\\\github.com\\\\vue-typescript\\\\node_modules\\\\.pnpm\\\\vue-loader@16.8.3_@vue+compiler-sfc@3.2.41_vue@3.2.41_webpack@4.46.0\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3929e0da\"]])\n\nexport default __exports__","import { defineComponent, openBlock, createElementBlock, createElementVNode } from 'vue';\nimport _export_sfc from './_virtual/plugin-vue_export-helper.mjs';\n\nconst _sfc_main = defineComponent({\n  name: \"Delete\"\n});\nconst _hoisted_1 = {\n  viewBox: \"0 0 1024 1024\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n};\nconst _hoisted_2 = /* @__PURE__ */ createElementVNode(\"path\", {\n  fill: \"currentColor\",\n  d: \"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z\"\n}, null, -1);\nconst _hoisted_3 = [\n  _hoisted_2\n];\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"svg\", _hoisted_1, _hoisted_3);\n}\nvar _delete = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\n\nexport { _delete as default };\n","interface IObjectStore {\r\n  name: string,\r\n  unique: boolean\r\n}\r\nclass Database {\r\n\r\n  public db: any = null\r\n  public request: any = null\r\n\r\n  connect(dbName: string, version: number = 1) {\r\n    return new Promise((resolve, reject) => {\r\n      this.request = window.indexedDB.open(dbName, version)\r\n      this.request.onsuccess = (e: EventTarget) => {\r\n        this.db = this.request.result\r\n        resolve(e)\r\n        this.success(e, '数据库打开成功')\r\n      }\r\n      this.request.onerror = (e: EventTarget) => {\r\n        reject(e)\r\n        this.error(e, '数据库打开报错')\r\n      }\r\n      this.request.onupgradeneeded = (e: any) => {\r\n        this.db = e.target.result\r\n        resolve(e)\r\n        this.success(null, '数据库升级成功')\r\n      }\r\n    })\r\n  }\r\n  upgrad(e: any) {\r\n    this.db = e.target.result\r\n  }\r\n  add(sql: string, value: any) {\r\n    const request = this.db.transaction([sql], 'readwrite')\r\n      .objectStore(sql)\r\n      .add(value)\r\n    request.onsuccess = (e: any) => {\r\n      this.success(e, '数据写入成功')\r\n    }\r\n    request.onerror = (e:  any) => {\r\n      this.error(e, '数据写入失败')\r\n    }\r\n  }\r\n  get(sql: string, value: any) {\r\n    return new Promise((resolve, reject) => {\r\n      const request = this.db\r\n        .transaction([sql])\r\n        .objectStore(sql)\r\n        .get(value)\r\n      request.onsuccess = () => {\r\n        resolve(request.result)\r\n        this.success.call(this, request.result, '')\r\n      }\r\n      request.onerror = this.error.call(this, '获取失败', '')\r\n    })\r\n  }\r\n  update(sql: string, value: any) {\r\n    const request = this.db\r\n      .transaction([sql], 'readwrite')\r\n      .objectStore(sql)\r\n      .put(value)\r\n    request.onsuccess = this.success.call(this, '数据更新成功', '')\r\n    request.onerror = this.error.call(this, '数据更新失败', '')\r\n  }\r\n  delete(sql: string, value: any) {\r\n    const request = this.db\r\n      .transaction([sql], 'readwrite')\r\n      .objectStore(sql)\r\n      .delete(value)\r\n    request.onsuccess = this.success.call(this, '数据删除成功', '')\r\n    request.onerror = this.error.call(this, '数据删除失败', '')\r\n  }\r\n  cursor(tableName: any) {\r\n    return new Promise((resolve, reject) => {\r\n      if (this.hasObjectStoreNames(tableName)) {\r\n        const request = this.db\r\n          .transaction([tableName])\r\n          .objectStore(tableName)\r\n          .openCursor()\r\n        request.onsuccess = (e: any) => {\r\n          resolve(e.target.result)\r\n          this.success(e, '遍历表数据成功')\r\n        }\r\n        request.onerror = (e: any) => {\r\n          reject(e)\r\n          this.error(e, '遍历表数据失败')\r\n        }\r\n      } else {\r\n        reject('表不存在')\r\n      }\r\n    })\r\n  }\r\n  createIndex(sql: string, value: any) {\r\n    this.db\r\n      .transaction([sql], 'readonly')\r\n      .objectStore(sql)\r\n      .index(value)\r\n  }\r\n  getIndex(sql: string, key: any, value: any) {\r\n    return new Promise((resolve, reject) => {\r\n      const request = this.db\r\n        .transaction([sql], 'readonly')\r\n        .objectStore(sql)\r\n        .index(key)\r\n        .get(value)\r\n      request.onsuccess = (e: any) => {\r\n        const result = e.target.result\r\n        if (result) {\r\n            resolve(result)\r\n        } else {\r\n            reject(e)\r\n        }\r\n      }\r\n      request.onerror = (e: any) => {\r\n        reject(e)\r\n        this.error.call(this, '获取索引失败', '')\r\n      }\r\n    })\r\n  }\r\n\r\n  hasObjectStoreNames(name: string) {\r\n    if (this.db.objectStoreNames.contains(name)) {\r\n      this.success(null, `${name} 表已存在`)\r\n      return true\r\n    } else {\r\n      this.error(null, `${name} 表不存在`)\r\n      return false\r\n    }\r\n  }\r\n\r\n  create(name: string, data: IObjectStore[], options: any) {\r\n    if (!this.db.objectStoreNames.contains(name)) {\r\n      let objectStore: any = null\r\n      if (options.keyPath) {\r\n        objectStore = this.db.createObjectStore(name, { keyPath: options.keyPath })\r\n      } else {\r\n        objectStore = this.db.createObjectStore(name, { autoIncrement: true })\r\n      }\r\n      data.forEach((item) => {\r\n        const name: string = item.name\r\n        const unique: boolean = item.unique\r\n        objectStore.createIndex(name, name, { unique })\r\n      })\r\n    }\r\n  }\r\n\r\n  success(e: EventTarget | any, message: string) {\r\n    console.log(e, message || 'success')\r\n  }\r\n  error(e: EventTarget | any, message: string) {\r\n    console.log(e, message || 'error')\r\n  }\r\n}\r\n\r\nexport default Database"],"sourceRoot":""}